---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# tukeygrps

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/tukeygrps)](https://cran.r-project.org/package=tukeygrps)
<!-- badges: end -->

Tukeygrps provides a simple helper function for the letter annotation of (gg)plots according to statistical differences between groups determined by a parametric Tukey-HSD test or a non-parametric Kruskal-wallis test.

## Installation

You can install tukeygrps from github using devtools:

``` {r, eval=FALSE}
install.packages("devtools")
install_github("leonardblaschek/tukeygrps")
```

## Examples

### Parametric comparisons 

The distributions and sample numbers in these example datasets don't always allow for the use of a parametric test such as the Tukey-HSD. Before you use this function, make sure that your observations are:

* **normally** distributed
* **homoscedastic**
* **independent** within and between groups
* **equal** sample sizes

If they are **not**, scroll down to the *non-parametric comparisons*.

Here we use tukey_groups() to quickly add letters to a geom_point plot. Alpha is set to 0.001, the letters are printed at y = 0, and there are no additional grouping variables.

```{r example no groups}
library(tukeygrps)
library(tidyverse)
data(mpg)
head(mpg)

tukey_letters <- tukey_groups(mpg, hwy, class, 0, 0.001)

head(tukey_letters)

ggplot() +
  geom_point(data = mpg, 
             aes(x = class,
                 y = hwy)) +
  geom_text(data = tukey_letters,
            aes(x = class,
                y = hwy,
                label = groups)) +
  coord_flip()
```

Here we split the statistical analysis by two grouping variables ("cut" and "color"), set the alpha to 0.05 and print the letters at y = -1000.

```{r example, warning=FALSE, message=FALSE}
library(tukeygrps)
library(tidyverse)

data(diamonds)
diamonds <- diamonds %>% 
  filter(cut %in% c("Ideal", "Premium", "Very Good") & color %in% c("D", "E", "F"))
head(diamonds)

tukey_letters <- tukey_groups(diamonds, price, clarity, -1000, 0.05, cut, color)

head(tukey_letters)

ggplot() +
  geom_boxplot(data = diamonds, 
             aes(x = clarity,
                 y = price)) +
  geom_text(data = tukey_letters,
            aes(x = clarity,
                y = price,
                label = groups)) +
  facet_grid(cut ~ color) +
  coord_flip()

```

### Non-parametric comparisons 

In case the above requirements for parametric tests are not met, we can fall back to the non-parametric Kruskalâ€“Wallis test with *p*-value adjustment for multiple comparisons.

```{r example non-parametric}
library(tukeygrps)
library(tidyverse)
data(mpg)
head(mpg)

kruskal_letters <- kruskal_groups(mpg, hwy, class, 0, 0.001, "holm")

head(kruskal_letters)

ggplot() +
  geom_point(data = mpg, 
             aes(x = class,
                 y = hwy)) +
  geom_text(data = kruskal_letters,
            aes(x = class,
                y = hwy,
                label = groups)) +
  coord_flip()
```
